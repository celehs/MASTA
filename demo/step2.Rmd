---
title: "Step 2: Model Fitting"
author: "https://celehs.github.io/PETLER/"
---

```{r, message=F}
source("setup.R")
```

```{r}
load("step1.RData")
```

```{r}
source("step2.R")
```

## Cheng

```{r}
plot(tseq[-1],exp(ht[-1]),type="l")
lines(tseq,h.fun(tseq,knots,Boundary.knots,bg.init.Cheng),col="red")
```

```{r}
plot(tseq[-1],ht[-1],type="l")
lines(tseq,log(h.fun(tseq,knots,Boundary.knots,bg.init.Cheng)),col="red")
```

# NPMLE

```{r}
plot(tseq,exp(ht),type="l")
lines(bbt_NPMLE[,1],exp(bbt_NPMLE[,2]),col="blue")
lines(tseq,h.fun(tseq,knots,Boundary.knots,bg.init.NPMLE),col="red")
```

```{r}
plot(tseq,ht,type="l")
lines(bbt_NPMLE[,1],bbt_NPMLE[,2],col="blue")
lines(tseq,log(h.fun(tseq,knots,Boundary.knots,bg.init.NPMLE)),col="red")
```

```{r}
str(bgbbest)
str(cstats)
```

```{r}
output
```

```{r}
proc.time()
```
